import ctypes
import os
import pygame
from random import randint
import win32com.client

pygame.init()
music = pygame.mixer.music.load('rosa.mp3')
pygame.mixer.music.play(loops=-1)

username = os.environ.get('USERNAME')
desktop = f'C:/Users/{username}/Desktop'

def tela():
    from time import sleep
    script_directory = os.path.dirname(os.path.abspath(__file__))

    Lula_coracao = 'amor.png'
    Dilma_lula = 'dilma.jpg'
    faz_o_L = 'l.jpg'
    brabo = 'brao.jpg'
    cora = 'coracao2.jpg'
    cora2 = 'coracao3.jpg'
    pinga = 'pinga.jpg'
    rmc = 'romantico.jpg'
    l = 'lulinha.jpg'



    SPI_SETDESKWALLPAPER = 20
    WALLPAPER_PATH = [os.path.join(script_directory, Lula_coracao),
                      os.path.join(script_directory, Dilma_lula),
                      os.path.join(script_directory, faz_o_L),
                      os.path.join(script_directory, brabo),
                      os.path.join(script_directory, cora),
                      os.path.join(script_directory, cora2),
                      os.path.join(script_directory, pinga),
                      os.path.join(script_directory, rmc),
                      os.path.join(script_directory, l)]
    contador = 0
    while True:
        ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER, 0, WALLPAPER_PATH[contador], 3)
        contador += 1 
        sleep(4)
        if contador >= len(WALLPAPER_PATH):
            contador = 0

print(username)
tela()